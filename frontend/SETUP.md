# 前端设置和测试指南

## 快速启动

### 1. 安装依赖
```bash
cd frontend
npm install
```

### 2. 配置环境变量
确保 `.env.local` 文件存在并配置正确：
```bash
NEXT_PUBLIC_API_URL=http://localhost:8000
```

### 3. 启动后端服务
在另一个终端窗口中启动后端：
```bash
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
python -m uvicorn app.main:app --reload
```

后端应该在 `http://localhost:8000` 运行。

### 4. 启动前端开发服务器
```bash
npm run dev
```

访问 `http://localhost:3000` 查看应用。

## 测试清单

### ✅ 基础功能测试

#### 1. 页面加载
- [ ] 访问 http://localhost:3000
- [ ] 页面正确显示标题："Transformer 计算可视化"
- [ ] 所有组件正确渲染（输入模块、控制面板、可视化画布、解释面板）

#### 2. 输入模块测试
- [ ] 输入框可以输入文本
- [ ] "显示高级配置" 按钮可以展开/收起配置选项
- [ ] 高级配置中所有输入框可编辑
- [ ] "开始计算" 按钮在未输入文本时禁用
- [ ] 输入文本后按钮变为可用

#### 3. 后端API集成测试
- [ ] 输入文本（例如："Hello world"）
- [ ] 点击"开始计算"按钮
- [ ] 检查是否显示"初始化中..."
- [ ] 成功后按钮显示"已初始化"
- [ ] 控制面板显示正确的步骤信息

#### 4. 控制面板测试
- [ ] 初始化前显示"请先输入文本并初始化计算"
- [ ] 初始化后显示步骤信息
- [ ] 进度条正确显示
- [ ] 播放/暂停按钮可点击
- [ ] 前进/后退按钮正常工作
- [ ] 步骤选择器下拉菜单可用
- [ ] 速度滑块可调节（0.5x - 3x）

#### 5. 自动播放测试
- [ ] 点击播放按钮
- [ ] 步骤自动递增
- [ ] 进度条自动更新
- [ ] 到达最后一步自动停止
- [ ] 暂停按钮可以停止播放

#### 6. 可视化画布测试
- [ ] 初始化前显示占位符
- [ ] 初始化后显示Token序列
- [ ] 当前步骤数据正确显示
- [ ] JSON数据格式化正确
- [ ] 元数据正确显示

#### 7. 解释面板测试
- [ ] 初始化前显示"等待计算初始化..."
- [ ] 初始化后显示步骤说明
- [ ] 详细解释正确显示
- [ ] 数据形状信息正确
- [ ] 层信息正确显示

#### 8. 响应式设计测试
- [ ] 大屏幕（> 1024px）：左右布局
- [ ] 小屏幕（< 1024px）：上下堆叠
- [ ] 移动设备视图正常

#### 9. 错误处理测试
- [ ] 后端未启动时显示错误信息
- [ ] 无效输入显示错误
- [ ] 网络错误有适当提示

#### 10. 重置功能测试
- [ ] 点击"重置"按钮
- [ ] 所有状态清空
- [ ] 可以重新开始新的计算

## 预期API交互

### 初始化请求
```bash
curl -X POST http://localhost:8000/api/init \
  -H "Content-Type: application/json" \
  -d '{
    "text": "Hello world",
    "config": {
      "n_vocab": 50257,
      "n_embd": 768,
      "n_layer": 12,
      "n_head": 12,
      "d_k": 64,
      "max_seq_len": 512
    }
  }'
```

### 步骤请求
```bash
curl -X POST http://localhost:8000/api/step \
  -H "Content-Type: application/json" \
  -d '{
    "session_id": "<session_id_from_init>",
    "step": 0
  }'
```

## 常见问题

### 问题：API请求失败
**解决方案**：
1. 检查后端是否在 http://localhost:8000 运行
2. 检查 `.env.local` 中的 `NEXT_PUBLIC_API_URL` 配置
3. 检查浏览器控制台的网络请求

### 问题：页面样式不正确
**解决方案**：
1. 清除浏览器缓存
2. 重启开发服务器
3. 删除 `.next` 文件夹并重新构建

### 问题：TypeScript 错误
**解决方案**：
1. 运行 `npm install` 确保所有依赖已安装
2. 检查 `tsconfig.json` 配置
3. 重启 IDE/编辑器

## 生产构建测试

```bash
# 构建生产版本
npm run build

# 启动生产服务器
npm start

# 访问 http://localhost:3000
```

检查：
- [ ] 构建无错误
- [ ] 生产版本正常运行
- [ ] 所有功能正常

## 性能检查

使用浏览器开发者工具：
- [ ] 页面加载时间 < 3秒
- [ ] 首次内容绘制 (FCP) < 1.5秒
- [ ] 最大内容绘制 (LCP) < 2.5秒
- [ ] 无内存泄漏
- [ ] 网络请求正常

## 浏览器兼容性

测试浏览器：
- [ ] Chrome (最新版本)
- [ ] Firefox (最新版本)
- [ ] Safari (最新版本)
- [ ] Edge (最新版本)

## 下一步

- [ ] 集成 D3.js 可视化
- [ ] 添加更多交互功能
- [ ] 优化性能
- [ ] 添加单元测试
